cabal-version:       2.2

name:                facet
version:             0.0.0.0
synopsis:            algebraic effects for elaboration
-- description:
homepage:            https://github.com/robrix/facet
bug-reports:         https://github.com/robrix/facet/issues
license:             BSD-3-Clause
license-file:        LICENSE
author:              Rob Rix
maintainer:          rob.rix@me.com
copyright:           2020 Rob Rix
category:            Language


common common
  default-language: Haskell2010
  ghc-options:
    -Weverything
    -Wno-all-missed-specialisations
    -Wno-implicit-prelude
    -Wno-missed-specialisations
    -Wno-missing-import-lists
    -Wno-missing-local-signatures
    -Wno-monomorphism-restriction
    -Wno-name-shadowing
    -Wno-safe
    -Wno-unsafe
  if (impl(ghc >= 8.8))
    ghc-options: -Wno-missing-deriving-strategies
  if (impl(ghc >= 8.10))
    ghc-options:
      -Wno-missing-safe-haskell-mode
      -Wno-prepositive-qualified-module
  default-extensions:
    DeriveTraversable
    DerivingStrategies
    DerivingVia
    DisambiguateRecordFields
    DuplicateRecordFields
    FlexibleContexts
    FlexibleInstances
    GeneralizedNewtypeDeriving
    LambdaCase
    MultiParamTypeClasses
    MultiWayIf
    NamedFieldPuns
    RankNTypes
    TupleSections
    TypeApplications
    TypeOperators

library
  import: common
  exposed-modules:
    Facet.Carrier.Error.Lens
    Facet.Carrier.Parser.Church
    Facet.Carrier.Readline.Haskeline
    Facet.Carrier.State.Lens
    Facet.Carrier.Throw.Inject
    Facet.Carrier.Trace.REPL
    Facet.CLI
    Facet.Context
    Facet.Core
    Facet.Diff
    Facet.Effect.Parser
    Facet.Effect.Readline
    Facet.Effect.Trace
    Facet.Elab
    Facet.Eval
    Facet.Flag
    Facet.Graph
    Facet.LSP
    Facet.Name
    Facet.Notice
    Facet.Notice.Elab
    Facet.Notice.Parser
    Facet.Lexer
    Facet.Parser
    Facet.Parser.Table
    Facet.Pretty
    Facet.Print
    Facet.REPL
    Facet.REPL.Parser
    Facet.Semiring
    Facet.Source
    Facet.Span
    Facet.Stack
    Facet.Style
    Facet.Surface
    Facet.Syntax
  other-modules:
    Paths_facet
  build-depends:
    , ansi-terminal
    , base ^>= 4.14
    , charset
    , colour
    , containers
    , data-default
    , directory
    , exceptions ^>= 0.10
    , filepath
    , fused-effects
    , fused-effects-lens
    , haskeline ^>= 0.8.1
    , haskell-lsp
    , haskell-lsp-types
    , lens
    , optparse-applicative
    , parsers
    , prettyprinter
    , semialign
    , silkscreen
    , text
    , these
    , time
    , transformers
    , unordered-containers
  hs-source-dirs: src


test-suite test
  import: common
  type: exitcode-stdio-1.0
  hs-source-dirs: test
  other-modules:
    Facet.Carrier.Parser.Church.Test
    Facet.Source.Test
  main-is: Test.hs
  build-depends:
    , base
    , containers
    , facet
    , hedgehog ^>= 1
    , parsers


executable facetc
  import: common
  main-is: Main.hs
  hs-source-dirs: facetc
  build-depends:
    , base
    , facet
